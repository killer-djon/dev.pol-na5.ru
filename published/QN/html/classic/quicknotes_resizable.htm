<html>
<head>
<title> 
<? $pageTitle ?>
</title>
<meta http-equiv="Content-Type" content="text/html; charset=<? $html_encoding ?>">
<link href="<? "styles.css"|stylesetitem:"classic":$styleSet ?>" rel="stylesheet" type="text/css">
<link href="../../../common/html/classic/tree_templates/tree_styles.css" rel="stylesheet" type="text/css">
<script src="../../../common/html/classic/styles/WebSubMenu.js"></script>
<script src="../../../common/html/classic/styles/popupmenu.js"></script>
<script src="../../../common/html/classic/tree_templates/tree_functions.js"></script>
<script language="JavaScript">
<!--
	function checkMinRights( rights )
	{
		thisForm = document.forms[0];
	
		for ( i = 0; i < thisForm.elements.length; i++ ) 
			if (thisForm.elements[i].type == 'checkbox')
				if ( thisForm.elements[i].name != "selectAllDocsCB" && thisForm.elements[i].checked ) {
					QN_ID = thisForm.elements[i].value;

					var rightsObj = tree_MM_findObj( "noterights["+QN_ID+"]" );
					if (!rightsObj)
						return false;

					if ( rightsObj.value < rights )
						return false;
				}
		
		return true;
	}

	function confirmFolderDeletion() 
	{
		return confirm( '<? $qnStrings.qn_screen_flddelete_message ?>' );
	}
	
	function alertDelete()
	{
		 alert( '<? $kernelStrings.app_treenoflddelrights_message ?>' );
		 return false;
	}

	function alertMove()
	{
		alert( '<? $kernelStrings.app_treenomovetosubfldrights_message ?>' );
		return false;
	}
	
	function alertCopy()
	{
		alert( '<? $kernelStrings.app_treenocopyfldrights_message ?>' );
		return false;
	}

	function alertAdd()
	{
		alert( '<? $kernelStrings.app_treenofldrights_message ?>' );
		return false;
	}
	
	function alertAddRoot()
	{
		alert( '<? $kernelStrings.app_treenorootrights_message ?>' );
		return false;
	}			
	
	function alertModify()
	{
		alert( '<? $kernelStrings.app_treeinvcurfldrights_message ?>' );
		return false;
	}

	function confirmCopy()
	{
		if ( !treeCheckSelection( '<? $qnStrings.qn_screen_emptycopy_message ?>' ) )
			return false;
			
		return true;	
	}
	
	function confirmMove()
	{
		if ( !treeCheckSelection( '<? $qnStrings.qn_screen_emptymove_message ?>' ) )
			return false;
			
		if ( !checkMinRights( 1 ) ) {
			alert( '<? $qnStrings.qn_screen_invrights_message ?>' );
			return false;
		}			
		
		return true;	
	}
	
	function confirmDeletion() 
	{	
		if ( !treeCheckSelection( '<? $qnStrings.qn_screen_emptydel_message ?>' ) )
			return false;
			
		if ( !checkMinRights( 1 ) ) {
			alert( '<? $qnStrings.qn_screen_invrights_message ?>' );
			return false;
		}			
	
		return confirm( '<? $qnStrings.qn_screen_confirmdel_message ?>' );
	}

	function submitFolder( obj ) 
	{
		selected = obj.selectedIndex;
		if ( obj.options[selected].value == -1 ) {
			return false;
		}

		obj.form.submit();
	}


	function findCurrentFolder()
	{
		obj = document.getElementById("<? $currentFolder ?>");
		if ( obj ) {
			obj.scrollIntoView();
		}
	}

//-->
</script>
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" class=noOverflow onLoad="initTreeDocumentView(); findCurrentFolder()">
<? strip ?>
<form action="<? $formLink ?>" method="post" enctype="multipart/form-data" name="form">
	<input type="hidden" name="btndummy">
	<input type="hidden" name="edited" value="1">
	<input type="hidden" name="curFolderID" value="<? $curFolderID ?>">
	<input type="hidden" name="currentPage" value="<? $currentPage ?>">

	<? assign var=toolbar value="../../../QN/html/classic/qn_toolbar.htm" ?>
	<? assign var=headerHeight value=92 ?>


	<? if !$fatalError ?>
		<? if !$noAccessGranted ?>

			<? assign var=rightPanelContent value="../../../QN/html/classic/notelist.htm" ?>
			<? if $searchString != "" ?>
				<? assign var=hideBottomPanel value=1 ?>
				<? assign var=rightPanelHeader value=$qnStrings.qn_sreen_searchresult_title ?>
			<? else ?>
				<? assign var=rightPanelHeader value=$curFolderName|htmlsafe:true:true ?>
			<? /if ?>
			
			<? if $statisticsMode ?>
				<? if $searchString == "" ?>
					<? assign var=hideBottomPanel value=1 ?>
					<? assign var=rightPanelHeader value=$kernelStrings.app_treeavailfolders_name ?>
					<? assign var=rightPanelContent value="../../../common/html/classic/tree_templates/tree_folders_summary.htm" ?>
					<? assign var=hidePages value=1 ?>				
					<? assign var=docsColumnName value=$qnStrings.qn_sreen_summarydoc_title ?>
				<? /if ?>
			<? /if ?>

			<? if $hideLeftPanel && $searchString == "" ?>
				<? assign var=topPanelFile value="../../../QN/html/classic/folderselector.htm" ?>
				<? assign var=foldersImage value="javascript:processTextButton('showFoldersBtn', 'form')" ?>
			<? /if ?>

			<? assign var=hideBottomPanel value=1 ?>
			<? assign var=topLevel value=true ?>
			<? assign var=leftPanel value="../../../QN/html/classic/catalog_panel.htm" ?>
			<? assign var=rightTopPanel value=$rightPanelContent ?>
			<? assign var=rightBottomPanel value="../../../common/html/classic/tree_templates/tree_folder_users.htm"?>
			<? assign var=leftPanelHeader value=$kernelStrings.app_treefolders_text?>
			<? assign var=numDocumentsLabel value=$qnStrings.qn_screen_numdocs_label?>
			<? assign var=leftPanelLinkTitle value=$kernelStrings.app_treeavailfolders_name?>


			<? include file="../../../common/html/classic/tree_templates/folder_document_resizable_view.htm" ?>

		<? else ?>
			<? include file="../../../common/html/classic/header.htm" ?>
			<? $qnStrings.qn_screen_noaccess_message|nl2br ?>
			<?include file="../../../common/html/classic/pagefooter.htm" ?>
		<? /if ?>
	<? else ?>
		<? include file="../../../common/html/classic/header.htm" ?>
		<? include file="../../../common/html/classic/errblock.htm" errorStr=$errorStr ?>
		<?include file="../../../common/html/classic/pagefooter.htm" ?>
	<? /if ?>

</form>
<? /strip ?>
</body>
</html>
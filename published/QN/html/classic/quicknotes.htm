<html>
<head>
<title> 
<? $pageTitle ?>
</title>
<meta http-equiv="Content-Type" content="text/html; charset=<? $html_encoding ?>">
<link href="<? "styles.css"|stylesetitem:"classic":$styleSet ?>" rel="stylesheet" type="text/css">
<script src="../../../common/html/classic/styles/WebSubMenu.js"></script>
<script src="../../../common/html/classic/styles/popupmenu.js"></script>
<script src="../../../common/html/classic/tree_templates/tree_functions.js"></script>
<script language="JavaScript">
<!--
	function checkMinRights( rights )
	{
		thisForm = document.forms[0];
	
		for ( i = 0; i < thisForm.elements.length; i++ ) 
			if (thisForm.elements[i].type == 'checkbox')
				if ( thisForm.elements[i].name != "selectAllDocsCB" && thisForm.elements[i].checked ) {
					QN_ID = thisForm.elements[i].value;

					var rightsObj = tree_MM_findObj( "noterights["+QN_ID+"]" );
					if (!rightsObj)
						return false;

					if ( rightsObj.value < rights )
						return false;
				}
		
		return true;
	}

	function confirmFolderDeletion() 
	{
		return confirm( '<? $qnStrings.qn_screen_flddelete_message ?>' );
	}
	
	function alertDelete()
	{
		 alert( '<? $kernelStrings.app_treenoflddelrights_message ?>' );
		 return false;
	}

	function alertMove()
	{
		alert( '<? $kernelStrings.app_treenomovetosubfldrights_message ?>' );
		return false;
	}
	
	function alertCopy()
	{
		alert( '<? $kernelStrings.app_treenocopyfldrights_message ?>' );
		return false;
	}

	function alertAdd()
	{
		alert( '<? $kernelStrings.app_treenofldrights_message ?>' );
		return false;
	}
	
	function alertAddRoot()
	{
		alert( '<? $kernelStrings.app_treenorootrights_message ?>' );
		return false;
	}			
	
	function alertModify()
	{
		alert( '<? $kernelStrings.app_treeinvcurfldrights_message ?>' );
		return false;
	}

	function confirmCopy()
	{
		if ( !treeCheckSelection( '<? $qnStrings.qn_screen_emptycopy_message ?>' ) )
			return false;
			
		return true;	
	}
	
	function confirmMove()
	{
		if ( !treeCheckSelection( '<? $qnStrings.qn_screen_emptymove_message ?>' ) )
			return false;
			
		if ( !checkMinRights( 1 ) ) {
			alert( '<? $qnStrings.qn_screen_invrights_message ?>' );
			return false;
		}			
		
		return true;	
	}
	
	function confirmDeletion() 
	{	
		if ( !treeCheckSelection( '<? $qnStrings.qn_screen_emptydel_message ?>' ) )
			return false;
			
		if ( !checkMinRights( 1 ) ) {
			alert( '<? $qnStrings.qn_screen_invrights_message ?>' );
			return false;
		}			
	
		return confirm( '<? $qnStrings.qn_screen_confirmdel_message ?>' );
	}

	function submitFolder( obj ) 
	{
		selected = obj.selectedIndex;
		if ( obj.options[selected].value == -1 ) {
			return false;
		}

		obj.form.submit();
	}

//-->
</script>
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" >
<? strip ?>
<form action="<? $formLink ?>" method="post" enctype="multipart/form-data" name="form">
  <input type="hidden" name="btndummy">
  <input type="hidden" name="edited" value="1">
  <input type="hidden" name="curFolderID" value="<? $curFolderID ?>">
  <input type="hidden" name="currentPage" value="<? $currentPage ?>">  
  <? include file="../../../common/html/classic/header.htm" nospace=1?>
  <? if !$fatalError && !$noAccess ?>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr> 
      <td class="pageTopPanel">
		<? if $searchString == "" ?>
			<? include file="../../../common/html/classic/toolbar_button.htm" align="left" caption=$qnStrings.qn_screen_folder_menu formname="form" space_right=#toolbarSmallSpace# button_menu=$folderMenu popupMenuIndex=1 menuIcon=1 showTopBar=1 menuClass="btnText" ?>
		<? /if ?>
		<? include file="../../../common/html/classic/toolbar_button.htm" align="left" caption=$qnStrings.qn_screen_notes_menu formname="form" space_right=#toolbarSmallSpace# button_menu=$fileMenu popupMenuIndex=2 menuIcon=1 showTopBar=1 menuClass="btnText" ?>
		<? include file="../../../common/html/classic/toolbar_button.htm" align="left" caption=$qnStrings.qn_screen_view_menu formname="form" space_right=#toolbarSmallSpace# button_menu=$viewMenu popupMenuIndex=3 menuIcon=1 showTopBar=1 menuClass="btnText" checkboxes=1 ?>
		<img src="<? "images/buttons/top_separator.gif"|stylesetitem:"classic":$styleSet ?>" border="0" align="left"> 
		<table border="0" cellpadding="0" cellspacing="0" align="left">
			<tr>
				<td><img src="<? "images/buttons/btn_separator.gif"|stylesetitem:"classic":$styleSet ?>" border="0" width="5" height="22"></td>
				<td valign="middle" class="btnText"><? $qnStrings.qn_screen_search_label|cat:":&nbsp;" ?></td>
				<td><input type="text" class="control" name="searchString" value="<? $searchString|htmlsafe:true:true ?>" style="width: 200px"></td>					
				<td>
				  <? include file="../../../common/html/classic/toolbar_button.htm" align="left" name="searchbtn" caption=$qnStrings.qn_screen_search_btn formname="form" space_left=#toolbarSmallSpace# ?>
				  <? if $searchString != "" ?>
					  <? include file="../../../common/html/classic/toolbar_button.htm" align="left" name="foldersbtn" caption=$qnStrings.qn_screen_showfolders_btn formname="form" space_left=#toolbarSmallSpace# ?>
				  <? /if ?>
				</td>
			</tr>
		</table>
	  </td>
    </tr>
  </table>
  <? /if ?>
  <? if $fatalError || $noAccess ?>
	  <? assign var=nospace value=0 ?>
  <? else ?>
	  <? assign var=nospace value=1 ?>
  <? /if ?>
  <? include file="../../../common/html/classic/toppanel_fix.htm" nospace=$nospace noleftspace=$nospace ?>
  <? include file="../../../common/html/classic/errblock.htm" errorStr=$errorStr margins=20 ?>
  <? if !$fatalError ?>
  		<? if !$noAccessGranted ?>		
			<? assign var=rightPanelContent value="../../../QN/html/classic/notelist.htm" ?>
			<? if $searchString != "" ?>
				<? assign var=hideBottomPanel value=1 ?>
				<? assign var=rightPanelHeader value=$qnStrings.qn_sreen_searchresult_title ?>
			<? else ?>
				<? assign var=rightPanelHeader value=$curFolderName|htmlsafe:true:true ?>
			<? /if ?>
			
			<? if $statisticsMode ?>
				<? if $searchString == "" ?>
					<? assign var=hideBottomPanel value=1 ?>
					<? assign var=rightPanelHeader value=$kernelStrings.app_treeavailfolders_name ?>
					<? assign var=rightPanelContent value="../../../common/html/classic/tree_templates/tree_folders_summary.htm" ?>
					<? assign var=hidePages value=1 ?>				
					<? assign var=docsColumnName value=$qnStrings.qn_sreen_summarydoc_title ?>
				<? /if ?>			
			<? /if ?>		

			<? if $hideLeftPanel && $searchString == "" ?>
				<? assign var=topPanelFile value="../../../QN/html/classic/folderselector.htm" ?>
				<? assign var=foldersImage value="javascript:processTextButton('showFoldersBtn', 'form')" ?>
			<? /if ?>

			<? assign var=hideBottomPanel value=1 ?>

			<? include file="../../../common/html/classic/tree_templates/folder_document_view.htm" topLevel=true leftPanel="../../../QN/html/classic/catalog_panel.htm" rightTopPanel=$rightPanelContent rightBottomPanel="../../../common/html/classic/tree_templates/tree_folder_users.htm" leftPanelHeader=$kernelStrings.app_treefolders_text rightPanelHeader=$rightPanelHeader numDocumentsLabel=$qnStrings.qn_screen_numdocs_label hideLeftPanel=$hideLeftPanel hideBottomPanel=$hideBottomPanel leftPanelLinkTitle=$kernelStrings.app_treeavailfolders_name ?>
		<? else ?>
			<? $qnStrings.qn_screen_noaccess_message|nl2br ?>
		<? /if ?>
  <? /if ?>
<?include file="../../../common/html/classic/pagefooter.htm" norightspace=1?>
</form>
<? /strip ?>
</body>
</html>
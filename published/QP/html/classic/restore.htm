<html>
<head>
<title>
<? $pageTitle ?>
</title>
<meta http-equiv="Content-Type" content="text/html; charset=<? $html_encoding ?>">
<link href="<? "styles.css"|stylesetitem:"classic":$styleSet ?>" rel="stylesheet" type="text/css">
<script src="../../../common/html/classic/styles/WebSubMenu.js"></script>
<script src="../../../common/html/classic/styles/popupmenu.js"></script>
<script src="../../../common/html/classic/tree_templates/tree_functions.js"></script>
<script language="JavaScript">
<!--

function MM_findObj(n, d) { //v4.0
	var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
	d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
	if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
	for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
	if(!x && document.getElementById) x=document.getElementById(n); return x;
}

function focusControl(objName) {
	var obj = MM_findObj(objName);
	if (obj) {
		obj.focus( );
	}
}

	function onCreateArchive()
	{
		thisForm = document.forms[0];

		if ( document.getElementById ) {
			var addFileCell = document.getElementById( 'optionscell' );
			if (addFileCell)
				addFileCell.style.display = "none";

			var attachMessageCell = document.getElementById( 'waitingcell' );
			if (attachMessageCell)
				attachMessageCell.style.display = "inline";
		}

		processTextButton( 'savebtn', 'form' );

		return false;
	}


	function checkFolderRights()
	{
		obj = MM_findObj("parentFolderID");
		if ( !obj )
			return onCreateArchive();

		selected = obj.selectedIndex;

		if ( obj.options[selected].value == -1 ) {
			alert( '<? $kernelStrings.app_treenofldrights_message ?>' );
			return false;
		}

		return onCreateArchive();
	}

	function changeFolder(obj)
	{
		selected = obj.selectedIndex;

		if ( obj.options[selected].value != -1 )
			obj.form.submit();
	}
//-->
</script>
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" <? if $invalidField == "" && $activeTab == "" ?> onLoad="focusControl('folderData[DF_NAME]')" <? /if ?> >
<? strip ?>
<form action="<? $formLink ?>" method="post" enctype="multipart/form-data" name="form" >
<? include file="../../../common/html/classic/header.htm"?>
<? include file="../../../common/html/classic/errblock.htm" errorStr=$errorStr ?>
	<? if $archiveSupported ?>
		<? if !$archiveCreated ?>
			<table cellpadding="0" cellspacing="0" border="0">
			<!-- Add file form -->
			<tr>
			<td ID="optionscell">
				<table width=500>
				<tr><td>
				<? if !$fatalError ?>
					<?include file="tree_addmodfolder.htm" updateOnFolderChange=$updateOnFolderChange parentFolderLabel=$kernelStrings.app_treeparentfolder_text folderNameLabel=$kernelStrings.app_treefurfldname_title folderSelectorEvent="changeFolder(this)" ?>
					<? include file="../../../common/html/classic/button.htm" align="left" name="savebtn" caption=$kernelStrings.app_save_btn formname="form" space_left=0 space_right=10 onClick="return checkFolderRights()" ?>
					<? include file="../../../common/html/classic/button.htm" align="left" name="cancelbtn" caption=$kernelStrings.app_cancel_btn formname="form"?>
				<? else ?>
					<? include file="../../../common/html/classic/button.htm" align="left" name="cancelbtn" caption=$kernelStrings.app_cancel_btn formname="form"?>
				<? /if ?>
				</td></tr>
				</table>
			</td></tr>
			<tr>
				<td ID="waitingcell" style="display:none">
					<p class="header2"><? $qpStrings.rst_restorearchive_text ?></p>
					<p><? $qpStrings.rst_restorewait_text ?></p>
					<p><img src="<? "images/progress.gif"|stylesetitem:"classic":$styleSet:"DD" ?>" ></p>
					<p><? include file="../../../common/html/classic/button.htm" align="left" link="quickpages.php" caption=$kernelStrings.app_cancel_btn formname="form"?></p>
				</td>
			</tr>
			</table>
		<? else ?>
				<input type=hidden name=archiveName value="<? $archiveName ?>">
				<input type=hidden name=fileNumber value="<? $fileNumber ?>">
				<input type=hidden name=fileSize value="<? $fileSize ?>">
				<input type=hidden name=filesAddedMessage value="<? $filesAddedMessage|htmlsafe:true:true ?>">
				<input type=hidden name=downloadArchiveLink value="<? $downloadArchiveLink|htmlsafe:true:true ?>">
				<input type=hidden name=archiveCreated value=1>
				<input type=hidden name=addMode value="<? $addMode ?>">
				<input type=hidden name=fileSizeInBytes value="<? $fileSizeInBytes ?>">

				<table border=0 cellpadding=0 cellspacing=2>
					<tr>
						<td><? $qpStrings.bak_archivecreated_label ?></td>
					</tr>
					<tr>
						<td><? $filesAddedMessage ?></td>
					</tr>
					<tr><td>&nbsp;</td></tr>
					<tr>
						<td><? $qpStrings.bak_filesize_label|cat:": "|cat:$fileSize ?></td>
					</tr>
					<tr><td>&nbsp;</td></tr>
					<tr><td><hr size=1 noshade width="100%"></td></tr>
					</tr>
					<tr><td height=5></td></tr>
					<tr>
						<td>
							<? include file="../../../common/html/classic/button.htm" align="left" link=$downloadArchiveLink caption=$qpStrings.bak_downloadarchive_btn formname="form"?>
						</td>
					<tr><td height=5></td></tr>
					<tr><td><hr size=1 noshade width="100%"></td></tr>
					<tr><td height=5></td></tr>
					<tr>
						<td>
							<? include file="../../../common/html/classic/button.htm" align="left" name="closebtn" caption=$qpStrings.bak_close_btn formname="form"?>
						</td>
					</tr>
				</table>
			<? /if ?>
		<? else ?>
			<table cellpadding=0 cellspacing=0 border=0>
				<tr>
					<td><? $qpStrings.app_archivesnotsupported_message|htmlsafe:true:true ?></td>
				</tr>
				<tr>
					<td>&nbsp;</td>
				</tr>
			</table>

			<? include file="../../../common/html/classic/button.htm" align="left" name="cancelbtn" caption=$kernelStrings.app_cancel_btn formname="form"?>
		<? /if ?>

  <input type="hidden" name="btndummy">
  <input type="hidden" name="action" value="<? $action ?>">
  <input type="hidden" name="edited" value="1">
  <input type="hidden" name="opener" value="<? $opener ?>">
  <input type="hidden" name="QPB_ID" value="<? $QPF_ID?>">
  <input type="hidden" name="QPB_ID_PARENT" value="<? $QPB_ID_PARENT ?>">
  <input type="hidden" name="folderData[QPB_ID]" value="<? $folderData.QPB_ID ?>">
  <input type="hidden" name="folderData[QPB_PUBLISHED]" value="<? $folderData.QPB_PUBLISHED ?>">
  <input type="hidden" name="QPB_PROPERTIES" value="<? $QPB_PROPERTIES ?>">
<?include file="../../../common/html/classic/pagefooter.htm"?>
</form>
<? /strip ?>
</body>
</html>
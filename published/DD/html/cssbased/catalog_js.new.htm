<script language="JavaScript">
<!--

	function checkMinRights( rights )
	{
		thisForm = document.forms[0];

		for ( i = 0; i < thisForm.elements.length; i++ )
			if (thisForm.elements[i].type == 'checkbox')
				if ( thisForm.elements[i].name != "selectAllDocsCB" && thisForm.elements[i].checked ) {
					DL_ID = thisForm.elements[i].value;

					var rightsObj = tree_MM_findObj( "filerights["+DL_ID+"]" );
					if (!rightsObj)
						return false;

					if ( rightsObj.value < rights )
						return false;
				}

		return true;
	}

	function showPopupMessage()
	{
		<? if $popupMessage ?>
			alert( "<? $popupMessage ?>" );
		<? /if ?>
	}

	function confirmDeletion()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptydel_message ?>' ) )
			return false;

		if ( !checkMinRights( 1 ) ) {
			alert( '<? $ddStrings.dd_screen_invrights_message ?>' );
			return false;
		}

		return confirm( '<? $ddStrings.dd_screen_confirmdel_message ?>' );
	}

	function confirmCheckIn()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptycheckin_message ?>' ) )
			return false;

		if ( !checkMinRights( 1 ) ) {
			alert( '<? $ddStrings.dd_screen_invcheckinrights_message ?>' );
			return false;
		}

		return confirm( '<? $ddStrings.dd_screen_confirmcheckin_message?>' );
	}

	function confirmCheckOut()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptycheckout_message ?>' ) )
			return false;

		return true;
	}

	function confirmRestore()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptyrestore_message ?>' ) )
			return false;

		return true;
	}

	function confirmCopy()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptycopy_message ?>' ) )
			return false;

		return true;
	}

	function confirmMove()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptymove_message ?>' ) )
			return false;

		if ( !checkMinRights( 1 ) ) {
			alert( '<? $ddStrings.dd_screen_invrights_message ?>' );
			return false;
		}

		return true;
	}

	function confirmFolderDeletion()
	{
		return confirm( '<? $ddStrings.dd_screen_flddelete_message ?>' );
	}

	function alertDelete()
	{
		 alert( '<? $kernelStrings.app_treenoflddelrights_message ?>' );
		 return false;
	}

	function alertMove()
	{
		alert( '<? $kernelStrings.app_treenomovetosubfldrights_message ?>' );
		return false;
	}

	function alertCopy()
	{
		alert( '<? $kernelStrings.app_treenocopyfldrights_message ?>' );
		return false;
	}

	function alertAdd()
	{
		alert( '<? $kernelStrings.app_treenofldrights_message ?>' );
		return false;
	}

	function alertAddRoot()
	{
		alert( '<? $kernelStrings.app_treenorootrights_message ?>' );
		return false;
	}

	function alertModify()
	{
		alert( '<? $kernelStrings.app_treeinvcurfldrights_message ?>' );
		return false;
	}

	function submitFolder( obj )
	{
		selected = obj.selectedIndex;
		if ( obj.options[selected].value == -1 ) {
			return false;
		}

		obj.form.submit();
	}

	function findCurrentFolder()
	{
		obj = document.getElementById("<? $currentFolder ?>");
		if ( obj ) {
			obj.scrollIntoView();
		}
	}

	function checkEmailList()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptyemail_message ?>' ) )
			return false;

		return true;
	}

	RegisterOnLoad( function(){ SplitterScrollPanel( '<? $currentFolder ?>' ) } );

//-->
</script>


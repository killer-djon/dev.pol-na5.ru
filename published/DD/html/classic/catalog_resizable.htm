<html>
<head>
<title> 
<? $pageTitle ?>
</title>
<meta http-equiv="Content-Type" content="text/html; charset=<? $html_encoding ?>">
<link href="<? "styles.css"|stylesetitem:"classic":$styleSet ?>" rel="stylesheet" type="text/css">
<link href="../../../common/html/classic/styles/fx.css" rel="stylesheet" type="text/css">
<link href="../../../common/html/classic/tree_templates/tree_styles.css" rel="stylesheet" type="text/css">
<script src="../../../common/html/classic/styles/popupmenu.js"></script>
<script src="../../../common/html/classic/styles/WebSubMenu.js"></script>
<script src="../../../common/html/classic/styles/popupmenu.js"></script>
<script src="../../../common/html/classic/tree_templates/tree_functions.js"></script>
<script language="JavaScript">
<!--
	function checkMinRights( rights )
	{
		thisForm = document.forms[0];
	
		for ( i = 0; i < thisForm.elements.length; i++ ) 
			if (thisForm.elements[i].type == 'checkbox')
				if ( thisForm.elements[i].name != "selectAllDocsCB" && thisForm.elements[i].checked ) {
					DL_ID = thisForm.elements[i].value;
					
					var rightsObj = tree_MM_findObj( "filerights["+DL_ID+"]" );
					if (!rightsObj)
						return false;
						
					if ( rightsObj.value < rights )
						return false;
				}
		
		return true;
	}

	function showPopupMessage()
	{
		<? if $popupMessage ?>
			alert( "<? $popupMessage ?>" );
		<? /if ?>
	}

	function confirmDeletion() 
	{	
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptydel_message ?>' ) )
			return false;
			
		if ( !checkMinRights( 1 ) ) {
			alert( '<? $ddStrings.dd_screen_invrights_message ?>' );
			return false;
		}			
	
		return confirm( '<? $ddStrings.dd_screen_confirmdel_message ?>' );
	}

	function confirmCheckIn()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptycheckin_message ?>' ) )
			return false;

		if ( !checkMinRights( 1 ) ) {
			alert( '<? $ddStrings.dd_screen_invcheckinrights_message ?>' );
			return false;
		}			
	
		return confirm( '<? $ddStrings.dd_screen_confirmcheckin_message?>' );
	}

	function confirmCheckOut()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptycheckout_message ?>' ) )
			return false;
			
		return true;
	}

	function confirmRestore() 
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptyrestore_message ?>' ) )
			return false;
			
		return true;
	}
	
	function confirmCopy()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptycopy_message ?>' ) )
			return false;
			
		return true;	
	}
	
	function confirmMove()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptymove_message ?>' ) )
			return false;
			
		if ( !checkMinRights( 1 ) ) {
			alert( '<? $ddStrings.dd_screen_invrights_message ?>' );
			return false;
		}			
		
		return true;	
	}
	
	function confirmFolderDeletion() 
	{
		return confirmDeletionAjax( '<? $ddStrings.dd_screen_flddelete_message ?>' );
	}
	
	function alertDelete()
	{
		 alert( '<? $kernelStrings.app_treenoflddelrights_message ?>' );
		 return false;
	}
	
	function alertMove()
	{
		alert( '<? $kernelStrings.app_treenomovetosubfldrights_message ?>' );
		return false;
	}
	
	function alertCopy()
	{
		alert( '<? $kernelStrings.app_treenocopyfldrights_message ?>' );
		return false;
	}
	
	function alertAdd()
	{
		alert( '<? $kernelStrings.app_treenofldrights_message ?>' );
		return false;
	}
	
	function alertAddRoot()
	{
		alert( '<? $kernelStrings.app_treenorootrights_message ?>' );
		return false;
	}			
	
	function alertModify()
	{
		alert( '<? $kernelStrings.app_treeinvcurfldrights_message ?>' );
		return false;
	}
	
	function submitFolder( obj ) 
	{
		selected = obj.selectedIndex;
		if ( obj.options[selected].value == -1 ) {
			return false;
		}
	
		obj.form.submit();
	}

	function findCurrentFolder()
	{
		obj = document.getElementById("<? $currentFolder ?>");
		if ( obj ) {
			obj.scrollIntoView();
		}
	}

	function checkEmailList()
	{
		if ( !treeCheckSelection( '<? $ddStrings.dd_screen_emptyemail_message ?>' ) )
			return false;
			
		return true;
	}

//-->
</script>
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" class=noOverflow onLoad="initTreeDocumentView(); findCurrentFolder(); showPopupMessage()">
<? strip ?>
<form action="<? $formLink ?>" method="post" enctype="multipart/form-data" name="form" >
	<input type="hidden" name="btndummy">
  <input type="hidden" name="lastCurrentPage" value="<? $currentPage ?>">   
  <input type="hidden" name="prevSearchString" value="<? $searchString?>">   

	<? assign var=toolbar value="../../../DD/html/classic/dd_toolbar.htm" ?>
	<? assign var=headerHeight value=92 ?>

<? if !$fatalError ?>
		<? if !$noAccessGranted ?>		
			<? assign var=rightPanelContent value="../../../DD/html/classic/filelist.htm" ?>
			<? if $searchString != "" ?>
				<? assign var=hideBottomPanel value=1 ?>
				<? assign var=rightPanelHeader value=$ddStrings.dd_sreen_searchresult_title ?>
			<? else ?>
				<? assign var=rightPanelHeader value=$curFolderName|htmlsafe:true:true ?>
			<? /if ?>
			
			<? if $statisticsMode ?>
				<? if $searchString == "" ?>
					<? assign var=hideBottomPanel value=1 ?>
					<? assign var=rightPanelHeader value=$kernelStrings.app_treeavailfolders_name ?>
					<? assign var=rightPanelContent value="../../../common/html/classic/tree_templates/tree_folders_summary.htm" ?>
					<? assign var=hidePages value=1 ?>				
					<? assign var=docsColumnName value=$ddStrings.dd_sreen_summarydoc_title ?>			
				<? /if ?>
			<? /if ?>

			<? if $hideLeftPanel && $searchString == "" ?>
				<? assign var=topPanelFile value="../../../DD/html/classic/folderselector.htm" ?>
				<? assign var=foldersImage value="javascript:processTextButton('showFoldersBtn', 'form')" ?>
			<? /if ?>

			<? assign var=hideBottomPanel value=1 ?>

			<? assign var=topLevel value=true ?>
			<? assign var=leftPanel value="../../../DD/html/classic/catalog_panel.htm" ?>
			<? assign var=rightTopPanel value=$rightPanelContent ?>
			<? assign var=rightBottomPanel value="../../../common/html/classic/tree_templates/tree_folder_users.htm" ?>
			<? assign var=leftPanelHeader value=$kernelStrings.app_treefolders_text ?>
			<? assign var=numDocumentsLabel value=$ddStrings.dd_screen_numdocs_label ?>
			<? assign var=leftPanelLinkTitle value=$kernelStrings.app_treeavailfolders_name ?>

			<? include file="../../../common/html/classic/tree_templates/folder_document_resizable_view.htm"?>
		<? else ?>
			<? include file="../../../common/html/classic/header.htm" ?>
			<? $ddStrings.dd_screen_noaccess_message|nl2br ?>
			<?include file="../../../common/html/classic/pagefooter.htm" ?>
		<? /if ?>
	<? else ?>
		<? include file="../../../common/html/classic/header.htm" ?>
		<? include file="../../../common/html/classic/errblock.htm" errorStr=$errorStr ?>
		<?include file="../../../common/html/classic/pagefooter.htm" ?>
	<? /if ?>
</form>
<? /strip ?>
</body>
</html>